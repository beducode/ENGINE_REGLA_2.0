DO
$$
DECLARE
	V_TABLEDROP VARCHAR;
	V_STR_QUERY TEXT;
BEGIN
FOR V_TABLEDROP IN
SELECT DISTINCT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES A
WHERE TABLE_CATALOG = 'IFRS9'
AND TABLE_SCHEMA = 'public'
AND TABLE_TYPE = 'BASE TABLE'
AND LEFT(RIGHT(TABLE_NAME, 13),3) = '_p_'
LOOP
	V_STR_QUERY := '';
	V_STR_QUERY := V_STR_QUERY || 'DROP TABLE IF EXISTS ' || V_TABLEDROP || '';
	EXECUTE (V_STR_QUERY);
	-- RAISE NOTICE '---> %', V_STR_QUERY;
END LOOP;
END;
$$;