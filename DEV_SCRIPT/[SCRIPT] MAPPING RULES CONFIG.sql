------ START PD CONFIG -----
SELECT A.PKID, 
A.PD_NAME AS TM_RULE_NAME,
B.PKID AS SEGMENTATION_ID,
A.PD_METHOD, ----> NEED UPDATE DI TABLE "PdConfiguration"
A.CALCULATION_METHOD AS CALC_METHOD, ----> NEED UPDATE DI TABLE "PdConfiguration"
C.UNIQUE_CODE AS BUCKET_GROUP, ----> NEED UPDATE DI TABLE "GroupBucket"
A.EXPECTED_LIFETIME AS EXPECTED_LIFE, ----> NEED UPDATE DI TABLE "PdConfiguration"
A.WINDOWS_MOVING AS INCREMENT_PERIOD, ----> NEED UPDATE DI TABLE "PdConfiguration"
A.HISTORICAL_DATA, ----> NEED UPDATE DI TABLE "PdConfiguration"
A.EFFECTIVE_END_DATE AS CUT_OFF_DATE, ----> NEED UPDATE DI TABLE "PdConfiguration"
CASE WHEN A.IS_ACTIVE = TRUE THEN 1 ELSE 0 END ACTIVE_FLAG,
0 AS IS_DELETE,
'SYSTEM' AS CREATEDBY,
CURRENT_DATE AS CREATEDDATE,
'LOCALHOST' AS CREATEDHOST,
A.DEFAULT_RATIO_BY, ----> NEED UPDATE DI TABLE "PdConfiguration"
'PENDING' AS RUNNING_STATUS
FROM "PdConfiguration" A
INNER JOIN "Segmentation" B ON A.SEGMENT_CODE = B.SYSCODE_SEGMENTATION
INNER JOIN "GroupBucket" C ON A.BUCKET_CODE = C.SYSCODE_GROUP_BUCKET
WHERE A.PKID = 108 AND A.IS_ACTIVE = TRUE;

------ END PD CONFIG -----

------ START LGD CONFIG -----
SELECT A.PKID,
B.PKID AS DEFAULT_RULE_ID,
A.LGD_NAME AS LGD_RULE_NAME,
A.PKID AS SEGMENTATION_ID,
A.LGD_METHOD AS LGD_METHOD,
A.HISTORICAL_DATA AS LGW_HISTORICAL_DATA,
A.WORKOUT_PERIOD AS WORKOUT_PERIOD,
A.LGD_MIN AS MIN_VALUE,
A.LGD_MAX AS MAX_VALUE,
A.EFFECTIVE_END_DATE::DATE AS CUT_OFF_DATE,
CASE WHEN A.IS_ACTIVE = TRUE THEN 1 ELSE 0 END ACTIVE_FLAG,
0 AS IS_DELETE,
'SYSTEM' AS CREATEDBY,
CURRENT_DATE AS CREATEDDATE,
'LOCALHOST' AS CREATEDHOST,
1 AS LAG_1MONTH_FLAG,
'PENDING' AS RUNNING_STATUS
FROM public."LgdConfiguration" A
INNER JOIN "DefaultCriteria" B ON A.DEFAULT_CRITERIA_CODE = B.SYSCODE_DEFAULT_CRITERIA
INNER JOIN "Segmentation" C ON A.SEGMENT_CODE = C.SYSCODE_SEGMENTATION;

------ END LGD CONFIG -----