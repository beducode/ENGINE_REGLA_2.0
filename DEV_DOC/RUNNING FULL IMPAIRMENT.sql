----- RUNNING 100k DATA

SELECT * FROM IFRS_PRC_DATE_AMORT;

/*

UPDATE IFRS_PRC_DATE
SET CURRDATE = '2025-08-31'::DATE,
PREVDATE = '2025-08-30'::DATE;

*/


SELECT
    schemaname,
    tablename,
    indexname,
    indexdef
FROM
    pg_indexes
WHERE
    tablename = 'ifrs_master_account';

-- DROP TABLE ifrs_master_account

-- SELECT DUPLICATE_TABLE('ifrs_master_account_100k','ifrs_master_account', false)


SELECT COUNT(*) FROM IFRS_MASTER_ACCOUNT;
SELECT MASTER_ACCOUNT_CODE, COUNT(*) FROM IFRS_MASTER_ACCOUNT GROUP BY MASTER_ACCOUNT_CODE
SELECT * FROM IFRS_MASTER_ACCOUNT WHERE MASTER_ACCOUNT_CODE= '00000G_0006201A10213_MAR' ORDER BY PKID ASC

/*

DROP TABLE ifrs_master_account CASCADE;

ALTER TABLE ifrs_master_account_100k RENAME TO ifrs_master_account;


SELECT DUPLICATE_TABLE('ifrs_master_account','ifrs_master_account_100k',false);

TRUNCATE TABLE IFRS_MASTER_ACCOUNT;

*/

select masterid, count(*) from ifrs_paym_schd_all group by masterid

/*
DROP TABLE ifrs_paym_schd_all;

ALTER TABLE ifrs_paym_schd_all_100k RENAME TO ifrs_paym_schd_all;

SELECT DUPLICATE_TABLE('ifrs_paym_schd_all','ifrs_paym_schd_all_100k',false);

TRUNCATE TABLE IFRS_PAYM_SCHD_ALL;

*/

SELECT B.* FROM IFRS_MASTER_ACCOUNT A
INNER JOIN IFRS_PAYM_SCHD_ALL B ON A.MASTERID = B.MASTERID
WHERE A.MASTERID = '00000G_0006201A10213_MAR_1'


SELECT LIFETIME, * FROM IFRS_MASTER_ACCOUNT_IMP WHERE MASTERID = '0000MT_0390191218101_KRN'


SELECT * FROM IFRS_EAD_TERM_YEARLY WHERE MASTERID = '0000MT_0390191218101_KRN_1' 

SELECT * FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_NAME LIKE '%tmp_ifrs_ecl_model_%'

SELECT * FROM IFRS_IMA_IMP_CURR WHERE MASTERID = '0000MT_0390191218101_KRN_1'  
SELECT * FROM TMP_IFRS_ECL_IMA WHERE MASTERID = '0000MT_0390191218101_KRN_1' 

SELECT * FROM IFRS_MSTR_SEGMENT_RULES_HEADER LIMIT 1



--- RESTORE TO PROCESS AMORT
-- ALTER TABLE ifrs_master_account_backup RENAME TO ifrs_master_account;

-- SELECT DOWNLOAD_DATE, COUNT(*) FROM IFRS_MASTER_ACCOUNT GROUP BY DOWNLOAD_DATE
/*

UPDATE IFRS_PRC_DATE_AMORT
SET CURRDATE = '2024-12-30'::DATE,
PREVDATE = '2024-12-29'::DATE;

*/


SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME LIKE '%ifrs_paym_schd_all%'

SELECT DOWNLOAD_DATE, COUNT(*) FROM IFRS_MASTER_ACCOUNT GROUP BY DOWNLOAD_DATE
