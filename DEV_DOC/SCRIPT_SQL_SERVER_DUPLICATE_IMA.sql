DECLARE @DuplicateCount INT = 20000;

-- Ambil nilai maksimum PKID sekarang
DECLARE @MaxPKID BIGINT;
SELECT @MaxPKID = ISNULL(MAX(PKID), 0) FROM IFRS_MASTER_ACCOUNT_IMP;

-- Buat generator angka 1–20000 menggunakan CROSS JOIN kecil
;WITH Numbers AS (
    SELECT ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS n
    FROM (
        SELECT 1 a
        FROM (VALUES (1),(2),(3),(4),(5),(6),(7),(8),(9),(10)) a1(a)
        CROSS JOIN (VALUES (1),(2),(3),(4),(5),(6),(7),(8),(9),(10)) a2(a)
        CROSS JOIN (VALUES (1),(2),(3),(4),(5),(6),(7),(8),(9),(10)) a3(a)
        CROSS JOIN (VALUES (1),(2),(3),(4),(5),(6),(7),(8),(9),(10)) a4(a)
        CROSS JOIN (VALUES (1),(2)) a5(a)  -- 10? * 2 = 20000
    ) t
)
--INSERT INTO IFRS_MASTER_ACCOUNT_IMP (
--    PKID,
--    DOWNLOAD_DATE,
--    MASTERID,
--    MASTER_ACCOUNT_CODE,
--    DATA_SOURCE,
--    GLOBAL_CUSTOMER_NUMBER,
--    CUSTOMER_NUMBER,
--    CUSTOMER_NAME,
--    FACILITY_NUMBER,
--    ACCOUNT_NUMBER,
--    PREVIOUS_ACCOUNT_NUMBER,
--    ACCOUNT_STATUS,
--    INTEREST_RATE,
--    MARKET_RATE,
--    PRODUCT_GROUP,
--    PRODUCT_TYPE,
--    PRODUCT_CODE,
--    PRODUCT_ENTITY,
--    GL_CONSTNAME,
--    BRANCH_CODE,
--    BRANCH_CODE_OPEN,
--    CURRENCY,
--    EXCHANGE_RATE,
--    INITIAL_OUTSTANDING,
--    OUTSTANDING,
--    OUTSTANDING_IDC,
--    OUTSTANDING_JF,
--    OUTSTANDING_BANK,
--    OUTSTANDING_PASTDUE,
--    OUTSTANDING_WO,
--    PLAFOND,
--    PLAFOND_CASH,
--    INTEREST_ACCRUED,
--    INSTALLMENT_AMOUNT,
--    UNUSED_AMOUNT,
--    DOWN_PAYMENT_AMOUNT,
--    JF_FLAG,
--    LOAN_START_DATE,
--    LOAN_DUE_DATE,
--    LOAN_START_AMORTIZATION,
--    LOAN_END_AMORTIZATION,
--    INSTALLMENT_GRACE_PERIOD,
--    NEXT_PAYMENT_DATE,
--    NEXT_INT_PAYMENT_DATE,
--    LAST_PAYMENT_DATE,
--    FIRST_INSTALLMENT_DATE,
--    TENOR,
--    REMAINING_TENOR,
--    PAYMENT_CODE,
--    PAYMENT_TERM,
--    INTEREST_CALCULATION_CODE,
--    INTEREST_PAYMENT_TERM,
--    RESTRUCTURE_DATE,
--    RESTRUCTURE_FLAG,
--    POCI_FLAG,
--    STAFF_LOAN_FLAG,
--    BELOW_MARKET_FLAG,
--    BTB_FLAG,
--    COMMITTED_FLAG,
--    REVOLVING_FLAG,
--    IAS_CLASS,
--    IFRS9_CLASS,
--    AMORT_TYPE,
--    EIR_STATUS,
--    ECF_STATUS,
--    EIR,
--    EIR_AMOUNT,
--    FAIR_VALUE_AMOUNT,
--    INITIAL_UNAMORT_TXN_COST,
--    INITIAL_UNAMORT_ORG_FEE,
--    UNAMORT_COST_AMT,
--    UNAMORT_FEE_AMT,
--    DAILY_AMORT_AMT,
--    UNAMORT_AMT_TOTAL_JF,
--    UNAMORT_FEE_AMT_JF,
--    UNAMORT_COST_AMT_JF,
--    ORIGINAL_COLLECTABILITY,
--    BI_COLLECTABILITY,
--    DAY_PAST_DUE,
--    DPD_START_DATE,
--    DPD_ZERO_COUNTER,
--    NPL_DATE,
--    NPL_FLAG,
--    DEFAULT_DATE,
--    DEFAULT_FLAG,
--    WRITEOFF_FLAG,
--    WRITEOFF_DATE,
--    IMPAIRED_FLAG,
--    IS_IMPAIRED,
--    GROUP_SEGMENT,
--    SEGMENT,
--    SUB_SEGMENT,
--    STAGE,
--    LIFETIME,
--    EAD_RULE_ID,
--    EAD_SEGMENT,
--    EAD_AMOUNT,
--    LGD_RULE_ID,
--    LGD_SEGMENT,
--    PD_RULE_ID,
--    PD_SEGMENT,
--    BUCKET_GROUP,
--    BUCKET_ID,
--    ECL_12_AMOUNT,
--    ECL_LIFETIME_AMOUNT,
--    ECL_AMOUNT,
--    CA_UNWINDING_AMOUNT,
--    IA_UNWINDING_AMOUNT,
--    IA_UNWINDING_SUM_AMOUNT,
--    BEGINNING_BALANCE,
--    ENDING_BALANCE,
--    WRITEBACK_AMOUNT,
--    CHARGE_AMOUNT,
--    CREATEDBY,
--    CREATEDDATE,
--    CREATEDHOST,
--    UPDATEDBY,
--    UPDATEDDATE,
--    UPDATEDHOST,
--    INITIAL_BENEFIT,
--    UNAMORT_BENEFIT,
--    SPPI_RESULT,
--    BM_RESULT,
--    ECONOMIC_SECTOR,
--    AO_CODE,
--    SUFFIX,
--    ACCOUNT_TYPE,
--    CUSTOMER_TYPE,
--    OUTSTANDING_PROFIT_DUE,
--    RESTRUCTURE_COLLECT_FLAG,
--    DPD_FINAL,
--    EIR_SEGMENT,
--    DPD_CIF,
--    DPD_FINAL_CIF,
--    BI_COLLECT_CIF,
--    PRODUCT_TYPE_1,
--    RATING_CODE,
--    CCF,
--    CCF_RULE_ID,
--    CCF_EFF_DATE,
--    ECL_AMOUNT_BFL,
--    AVG_EIR,
--    ECL_MODEL_ID,
--    SEGMENTATION_ID,
--    PD_ME_MODEL_ID,
--    DEFAULT_RULE_ID,
--    PLAFOND_CIF,
--    RESTRUCTURE_COLLECT_FLAG_CIF,
--    SOURCE_SYSTEM,
--    INITIAL_RATING_CODE,
--    PD_INITIAL_RATE,
--    PD_CURRENT_RATE,
--    PD_CHANGE,
--    LIMIT_CURRENCY,
--    SUN_ID,
--    RATING_DOWNGRADE,
--    EXT_RATING_AGENCY,
--    EXT_RATING_CODE,
--    EXT_INIT_RATING_CODE,
--    INTEREST_TYPE,
--    SOVEREIGN_FLAG,
--    ISIN_CODE,
--    INV_TYPE,
--    UNAMORT_DISCOUNT_PREMIUM,
--    DISCOUNT_PREMIUM_AMOUNT,
--    WATCHLIST_FLAG,
--    COLL_AMOUNT,
--    FACILITY_NUMBER_PARENT,
--    PRODUCT_CODE_T24,
--    EXT_RATING_DOWNGRADE,
--    SANDI_BANK,
--    EARLY_PAYMENT,
--    EARLY_PAYMENT_FLAG,
--    EARLY_PAYMENT_DATE,
--    LOB_CODE,
--    COUNTER_GUARANTEE_FLAG,
--    SEGMENT_FLAG
--)
SELECT
    @MaxPKID + ROW_NUMBER() OVER (ORDER BY src.PKID, n.n) AS PKID,
    src.DOWNLOAD_DATE,
    CONCAT(src.MASTERID, '_', n.n) AS MASTERID,
    src.MASTER_ACCOUNT_CODE,
    src.DATA_SOURCE,
    src.GLOBAL_CUSTOMER_NUMBER,
    src.CUSTOMER_NUMBER,
    src.CUSTOMER_NAME,
    src.FACILITY_NUMBER,
    src.ACCOUNT_NUMBER,
    src.PREVIOUS_ACCOUNT_NUMBER,
    src.ACCOUNT_STATUS,
    src.INTEREST_RATE,
    src.MARKET_RATE,
    src.PRODUCT_GROUP,
    src.PRODUCT_TYPE,
    src.PRODUCT_CODE,
    src.PRODUCT_ENTITY,
    src.GL_CONSTNAME,
    src.BRANCH_CODE,
    src.BRANCH_CODE_OPEN,
    src.CURRENCY,
    src.EXCHANGE_RATE,
    src.INITIAL_OUTSTANDING,
    src.OUTSTANDING,
    src.OUTSTANDING_IDC,
    src.OUTSTANDING_JF,
    src.OUTSTANDING_BANK,
    src.OUTSTANDING_PASTDUE,
    src.OUTSTANDING_WO,
    src.PLAFOND,
    src.PLAFOND_CASH,
    src.INTEREST_ACCRUED,
    src.INSTALLMENT_AMOUNT,
    src.UNUSED_AMOUNT,
    src.DOWN_PAYMENT_AMOUNT,
    src.JF_FLAG,
    src.LOAN_START_DATE,
    src.LOAN_DUE_DATE,
    src.LOAN_START_AMORTIZATION,
    src.LOAN_END_AMORTIZATION,
    src.INSTALLMENT_GRACE_PERIOD,
    src.NEXT_PAYMENT_DATE,
    src.NEXT_INT_PAYMENT_DATE,
    src.LAST_PAYMENT_DATE,
    src.FIRST_INSTALLMENT_DATE,
    src.TENOR,
    src.REMAINING_TENOR,
    src.PAYMENT_CODE,
    src.PAYMENT_TERM,
    src.INTEREST_CALCULATION_CODE,
    src.INTEREST_PAYMENT_TERM,
    src.RESTRUCTURE_DATE,
    src.RESTRUCTURE_FLAG,
    src.POCI_FLAG,
    src.STAFF_LOAN_FLAG,
    src.BELOW_MARKET_FLAG,
    src.BTB_FLAG,
    src.COMMITTED_FLAG,
    src.REVOLVING_FLAG,
    src.IAS_CLASS,
    src.IFRS9_CLASS,
    src.AMORT_TYPE,
    src.EIR_STATUS,
    src.ECF_STATUS,
    src.EIR,
    src.EIR_AMOUNT,
    src.FAIR_VALUE_AMOUNT,
    src.INITIAL_UNAMORT_TXN_COST,
    src.INITIAL_UNAMORT_ORG_FEE,
    src.UNAMORT_COST_AMT,
    src.UNAMORT_FEE_AMT,
    src.DAILY_AMORT_AMT,
    src.UNAMORT_AMT_TOTAL_JF,
    src.UNAMORT_FEE_AMT_JF,
    src.UNAMORT_COST_AMT_JF,
    src.ORIGINAL_COLLECTABILITY,
    src.BI_COLLECTABILITY,
    src.DAY_PAST_DUE,
    src.DPD_START_DATE,
    src.DPD_ZERO_COUNTER,
    src.NPL_DATE,
    src.NPL_FLAG,
    src.DEFAULT_DATE,
    src.DEFAULT_FLAG,
    src.WRITEOFF_FLAG,
    src.WRITEOFF_DATE,
    src.IMPAIRED_FLAG,
    src.IS_IMPAIRED,
    src.GROUP_SEGMENT,
    src.SEGMENT,
    src.SUB_SEGMENT,
    src.STAGE,
    src.LIFETIME,
    src.EAD_RULE_ID,
    src.EAD_SEGMENT,
    src.EAD_AMOUNT,
    src.LGD_RULE_ID,
    src.LGD_SEGMENT,
    src.PD_RULE_ID,
    src.PD_SEGMENT,
    src.BUCKET_GROUP,
    src.BUCKET_ID,
    src.ECL_12_AMOUNT,
    src.ECL_LIFETIME_AMOUNT,
    src.ECL_AMOUNT,
    src.CA_UNWINDING_AMOUNT,
    src.IA_UNWINDING_AMOUNT,
    src.IA_UNWINDING_SUM_AMOUNT,
    src.BEGINNING_BALANCE,
    src.ENDING_BALANCE,
    src.WRITEBACK_AMOUNT,
    src.CHARGE_AMOUNT,
    src.CREATEDBY,
    src.CREATEDDATE,
    src.CREATEDHOST,
    src.UPDATEDBY,
    src.UPDATEDDATE,
    src.UPDATEDHOST,
    src.INITIAL_BENEFIT,
    src.UNAMORT_BENEFIT,
    src.SPPI_RESULT,
    src.BM_RESULT,
    src.ECONOMIC_SECTOR,
    src.AO_CODE,
    src.SUFFIX,
    src.ACCOUNT_TYPE,
    src.CUSTOMER_TYPE,
    src.OUTSTANDING_PROFIT_DUE,
    src.RESTRUCTURE_COLLECT_FLAG,
    src.DPD_FINAL,
    src.EIR_SEGMENT,
    src.DPD_CIF,
    src.DPD_FINAL_CIF,
    src.BI_COLLECT_CIF,
    src.PRODUCT_TYPE_1,
    src.RATING_CODE,
    src.CCF,
    src.CCF_RULE_ID,
    src.CCF_EFF_DATE,
    src.ECL_AMOUNT_BFL,
    src.AVG_EIR,
    src.ECL_MODEL_ID,
    src.SEGMENTATION_ID,
    src.PD_ME_MODEL_ID,
    src.DEFAULT_RULE_ID,
    src.PLAFOND_CIF,
    src.RESTRUCTURE_COLLECT_FLAG_CIF,
    src.SOURCE_SYSTEM,
    src.INITIAL_RATING_CODE,
    src.PD_INITIAL_RATE,
    src.PD_CURRENT_RATE,
    src.PD_CHANGE,
    src.LIMIT_CURRENCY,
    src.SUN_ID,
    src.RATING_DOWNGRADE,
    src.EXT_RATING_AGENCY,
    src.EXT_RATING_CODE,
    src.EXT_INIT_RATING_CODE,
    src.INTEREST_TYPE,
    src.SOVEREIGN_FLAG,
    src.ISIN_CODE,
    src.INV_TYPE,
    src.UNAMORT_DISCOUNT_PREMIUM,
    src.DISCOUNT_PREMIUM_AMOUNT,
    src.WATCHLIST_FLAG,
    src.COLL_AMOUNT,
    src.FACILITY_NUMBER_PARENT,
    src.PRODUCT_CODE_T24,
    src.EXT_RATING_DOWNGRADE,
    src.SANDI_BANK,
    src.EARLY_PAYMENT,
    src.EARLY_PAYMENT_FLAG,
    src.EARLY_PAYMENT_DATE,
    src.LOB_CODE,
    src.COUNTER_GUARANTEE_FLAG,
    src.SEGMENT_FLAG
FROM IFRS_MASTER_ACCOUNT_IMP src
CROSS JOIN Numbers n
WHERE n.n <= @DuplicateCount;
