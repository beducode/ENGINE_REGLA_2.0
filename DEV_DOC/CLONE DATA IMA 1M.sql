DO
$$
DECLARE
    duplicate_count INTEGER := 200000;
    max_pkid BIGINT;
BEGIN
    -- Ambil nilai maksimum PKID dari tabel target
    SELECT COALESCE(MAX(pkid), 0) INTO max_pkid FROM IFRS_MASTER_ACCOUNT_IMP;

    -- Gunakan CTE untuk membangkitkan angka 1â€“200000
    WITH numbers AS (
        SELECT generate_series(1, duplicate_count) AS n
    )
	---- SELECT COUNT(*) FROM IFRS_MASTER_ACCOUNT_1M;
    INSERT INTO IFRS_MASTER_ACCOUNT_1M (
        pkid,
        download_date,
        masterid,
        master_account_code,
        data_source,
        global_customer_number,
        customer_number,
        customer_name,
        facility_number,
        account_number,
        previous_account_number,
        account_status,
        interest_rate,
        market_rate,
        product_group,
        product_type,
        product_code,
        product_entity,
        gl_constname,
        branch_code,
        branch_code_open,
        currency,
        exchange_rate,
        initial_outstanding,
        outstanding,
        outstanding_idc,
        outstanding_jf,
        outstanding_bank,
        outstanding_pastdue,
        outstanding_wo,
        plafond,
        plafond_cash,
        interest_accrued,
        installment_amount,
        unused_amount,
        down_payment_amount,
        jf_flag,
        loan_start_date,
        loan_due_date,
        loan_start_amortization,
        loan_end_amortization,
        installment_grace_period,
        next_payment_date,
        next_int_payment_date,
        last_payment_date,
        first_installment_date,
        tenor,
        remaining_tenor,
        payment_code,
        payment_term,
        interest_calculation_code,
        interest_payment_term,
        restructure_date,
        restructure_flag,
        poci_flag,
        staff_loan_flag,
        below_market_flag,
        btb_flag,
        committed_flag,
        revolving_flag,
        ias_class,
        ifrs9_class,
        amort_type,
        eir_status,
        ecf_status,
        eir,
        eir_amount,
        fair_value_amount,
        initial_unamort_txn_cost,
        initial_unamort_org_fee,
        unamort_cost_amt,
        unamort_fee_amt,
        daily_amort_amt,
        unamort_amt_total_jf,
        unamort_fee_amt_jf,
        unamort_cost_amt_jf,
        original_collectability,
        bi_collectability,
        day_past_due,
        dpd_start_date,
        dpd_zero_counter,
        npl_date,
        npl_flag,
        default_date,
        default_flag,
        writeoff_flag,
        writeoff_date,
        impaired_flag,
        is_impaired,
        group_segment,
        segment,
        sub_segment,
        stage,
        lifetime,
        ead_rule_id,
        ead_segment,
        ead_amount,
        lgd_rule_id,
        lgd_segment,
        pd_rule_id,
        pd_segment,
        bucket_group,
        bucket_id,
        ecl_12_amount,
        ecl_lifetime_amount,
        ecl_amount,
        ca_unwinding_amount,
        ia_unwinding_amount,
        ia_unwinding_sum_amount,
        beginning_balance,
        ending_balance,
        writeback_amount,
        charge_amount,
        createdby,
        createddate,
        createdhost,
        updatedby,
        updateddate,
        updatedhost,
        initial_benefit,
        unamort_benefit,
        sppi_result,
        bm_result,
        economic_sector,
        ao_code,
        suffix,
        account_type,
        customer_type,
        outstanding_profit_due,
        restructure_collect_flag,
        dpd_final,
        eir_segment,
        dpd_cif,
        dpd_final_cif,
        bi_collect_cif,
        product_type_1,
        rating_code,
        ccf,
        ccf_rule_id,
        ccf_eff_date,
        ecl_amount_bfl,
        avg_eir,
        ecl_model_id,
        segmentation_id,
        pd_me_model_id,
        default_rule_id,
        plafond_cif,
        restructure_collect_flag_cif,
        source_system,
        initial_rating_code,
        pd_initial_rate,
        pd_current_rate,
        pd_change,
        limit_currency,
        sun_id,
        rating_downgrade,
        ext_rating_agency,
        ext_rating_code,
        ext_init_rating_code,
        interest_type,
        sovereign_flag,
        isin_code,
        inv_type,
        unamort_discount_premium,
        discount_premium_amount,
        watchlist_flag,
        coll_amount,
        facility_number_parent,
        product_code_t24,
        ext_rating_downgrade,
        sandi_bank,
        early_payment,
        early_payment_flag,
        early_payment_date,
        lob_code,
        counter_guarantee_flag,
        segment_flag
    )
    SELECT
        max_pkid + ROW_NUMBER() OVER (ORDER BY src.pkid, n.n) AS pkid,
        src.download_date,
        src.masterid || '_' || n.n AS masterid,
        src.master_account_code,
        src.data_source,
        src.global_customer_number,
        src.customer_number,
        src.customer_name,
        src.facility_number,
        src.account_number,
        src.previous_account_number,
        src.account_status,
        src.interest_rate,
        src.market_rate,
        src.product_group,
        src.product_type,
        src.product_code,
        src.product_entity,
        src.gl_constname,
        src.branch_code,
        src.branch_code_open,
        src.currency,
        src.exchange_rate,
        src.initial_outstanding,
        src.outstanding,
        src.outstanding_idc,
        src.outstanding_jf,
        src.outstanding_bank,
        src.outstanding_pastdue,
        src.outstanding_wo,
        src.plafond,
        src.plafond_cash,
        src.interest_accrued,
        src.installment_amount,
        src.unused_amount,
        src.down_payment_amount,
        src.jf_flag,
        src.loan_start_date,
        src.loan_due_date,
        src.loan_start_amortization,
        src.loan_end_amortization,
        src.installment_grace_period,
        src.next_payment_date,
        src.next_int_payment_date,
        src.last_payment_date,
        src.first_installment_date,
        src.tenor,
        src.remaining_tenor,
        src.payment_code,
        src.payment_term,
        src.interest_calculation_code,
        src.interest_payment_term,
        src.restructure_date,
        src.restructure_flag,
        src.poci_flag,
        src.staff_loan_flag,
        src.below_market_flag,
        src.btb_flag,
        src.committed_flag,
        src.revolving_flag,
        src.ias_class,
        src.ifrs9_class,
        src.amort_type,
        src.eir_status,
        src.ecf_status,
        src.eir,
        src.eir_amount,
        src.fair_value_amount,
        src.initial_unamort_txn_cost,
        src.initial_unamort_org_fee,
        src.unamort_cost_amt,
        src.unamort_fee_amt,
        src.daily_amort_amt,
        src.unamort_amt_total_jf,
        src.unamort_fee_amt_jf,
        src.unamort_cost_amt_jf,
        src.original_collectability,
        src.bi_collectability,
        src.day_past_due,
        src.dpd_start_date,
        src.dpd_zero_counter,
        src.npl_date,
        src.npl_flag,
        src.default_date,
        src.default_flag,
        src.writeoff_flag,
        src.writeoff_date,
        src.impaired_flag,
        src.is_impaired,
        src.group_segment,
        src.segment,
        src.sub_segment,
        src.stage,
        src.lifetime,
        src.ead_rule_id,
        src.ead_segment,
        src.ead_amount,
        src.lgd_rule_id,
        src.lgd_segment,
        src.pd_rule_id,
        src.pd_segment,
        src.bucket_group,
        src.bucket_id,
        src.ecl_12_amount,
        src.ecl_lifetime_amount,
        src.ecl_amount,
        src.ca_unwinding_amount,
        src.ia_unwinding_amount,
        src.ia_unwinding_sum_amount,
        src.beginning_balance,
        src.ending_balance,
        src.writeback_amount,
        src.charge_amount,
        src.createdby,
        src.createddate,
        src.createdhost,
        src.updatedby,
        src.updateddate,
        src.updatedhost,
        src.initial_benefit,
        src.unamort_benefit,
        src.sppi_result,
        src.bm_result,
        src.economic_sector,
        src.ao_code,
        src.suffix,
        src.account_type,
        src.customer_type,
        src.outstanding_profit_due,
        src.restructure_collect_flag,
        src.dpd_final,
        src.eir_segment,
        src.dpd_cif,
        src.dpd_final_cif,
        src.bi_collect_cif,
        src.product_type_1,
        src.rating_code,
        src.ccf,
        src.ccf_rule_id,
        src.ccf_eff_date,
        src.ecl_amount_bfl,
        src.avg_eir,
        src.ecl_model_id,
        src.segmentation_id,
        src.pd_me_model_id,
        src.default_rule_id,
        src.plafond_cif,
        src.restructure_collect_flag_cif,
        src.source_system,
        src.initial_rating_code,
        src.pd_initial_rate,
        src.pd_current_rate,
        src.pd_change,
        src.limit_currency,
        src.sun_id,
        src.rating_downgrade,
        src.ext_rating_agency,
        src.ext_rating_code,
        src.ext_init_rating_code,
        src.interest_type,
        src.sovereign_flag,
        src.isin_code,
        src.inv_type,
        src.unamort_discount_premium,
        src.discount_premium_amount,
        src.watchlist_flag,
        src.coll_amount,
        src.facility_number_parent,
        src.product_code_t24,
        src.ext_rating_downgrade,
        src.sandi_bank,
        src.early_payment,
        src.early_payment_flag,
        src.early_payment_date,
        src.lob_code,
        src.counter_guarantee_flag,
        src.segment_flag
    FROM IFRS_MASTER_ACCOUNT_IMP src
    CROSS JOIN numbers n;
	---- SELECT * FROM IFRS_MASTER_ACCOUNT_IMP;

    RAISE NOTICE 'Insert duplicate % per record complete.', duplicate_count;
END
$$;
