DROP VIEW IF EXISTS VW_PRC_DATE CASCADE;

CREATE VIEW VW_PRC_DATE AS
SELECT * FROM dblink('workflow_ntt_parameter','SELECT PKID, 
PRC_DATE AS CURRDATE,
PREVIOUS_DATE AS PREVDATE,
''PENDING'' AS BATCH_STATUS,
''-'' AS REMARK,
COALESCE(LAST_PROCESS_DATE,CURRENT_DATE) AS LAST_PROCESS_DATE,
PG_BACKEND_PID() AS SESSIONID,
CREATED_BY AS CREATEDBY,
CREATED_DATE AS CREATEDDATE,
CREATED_HOST AS CREATEDHOST,
UPDATED_BY AS UPDATEDBY,
UPDATED_DATE AS UPDATEDDATE,
UPDATED_HOST AS UPDATEDHOST
FROM "PrcDate" WHERE CODE_APP = ''IFRS_9''') AS PRC_DATE(PKID BIGINT
,CURRDATE DATE
,PREVDATE DATE
,BATCH_STATUS CHARACTER VARYING(50)
,REMARK CHARACTER VARYING(250)
,LAST_PROCESS_DATE DATE
,SESSIONID CHARACTER VARYING(50)
,CREATEDBY CHARACTER VARYING(36)
,CREATEDDATE TIMESTAMP WITHOUT TIME ZONE
,CREATEDHOST CHARACTER VARYING(30)
,UPDATEDBY CHARACTER VARYING(36)
,UPDATEDDATE TIMESTAMP WITHOUT TIME ZONE
,UPDATEDHOST CHARACTER VARYING(30));