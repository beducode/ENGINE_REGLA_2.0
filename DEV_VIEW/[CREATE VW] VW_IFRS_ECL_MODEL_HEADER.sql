DROP VIEW IF EXISTS VW_IFRS_ECL_MODEL_HEADER CASCADE;

CREATE VIEW VW_IFRS_ECL_MODEL_HEADER 
AS
 SELECT MAX(A.PKID) AS PKID,
    MAX(A.ECL_CONFIGURATION_NAME) AS ECL_MODEL_NAME,
    CURRENT_DATE AS DATA_DATE,
	MAX(CASE A.IS_ACTIVE
		WHEN TRUE THEN '1'::TEXT
		ELSE '0'::TEXT
	END) AS ACTIVE_STATUS,
    'PENDING' AS RUN_STATUS,
    0 AS IS_DELETE,
    MAX(A.CREATED_BY) AS CREATEDBY,
    MAX(A.CREATED_DATE) AS CREATEDDATE,
    MAX(A.CREATED_HOST) AS CREATEDHOST,
    MAX(A.UPDATED_BY) AS UPDATEDBY,
    MAX(A.UPDATED_DATE) AS UPDATEDDATE,
    MAX(A.UPDATED_HOST) AS UPDATEDHOST
   FROM ( SELECT ECLCONFIGURATION.PKID,
            ECLCONFIGURATION.ECL_CONFIGURATION_NAME,
            ECLCONFIGURATION.IS_ACTIVE,
            ECLCONFIGURATION.CREATED_BY,
            ECLCONFIGURATION.CREATED_DATE,
            ECLCONFIGURATION.CREATED_HOST,
            ECLCONFIGURATION.UPDATED_BY,
            ECLCONFIGURATION.UPDATED_DATE,
            ECLCONFIGURATION.UPDATED_HOST
           FROM dblink('workflow_ntt_impairment'::TEXT, '
		SELECT PKID,
		ECL_CONFIGURATION_NAME ,
		IS_ACTIVE ,
		CREATED_BY ,
		CREATED_DATE ,
		CREATED_HOST ,
		UPDATED_BY ,
		UPDATED_DATE,
		UPDATED_HOST
		FROM "EclConfiguration" '::TEXT) ECLCONFIGURATION(PKID BIGINT, ECL_CONFIGURATION_NAME CHARACTER VARYING, IS_ACTIVE BOOLEAN, CREATED_BY CHARACTER VARYING, CREATED_DATE TIMESTAMP WITHOUT TIME ZONE, CREATED_HOST CHARACTER VARYING, UPDATED_BY CHARACTER VARYING, UPDATED_DATE TIMESTAMP WITHOUT TIME ZONE, UPDATED_HOST CHARACTER VARYING)) A;