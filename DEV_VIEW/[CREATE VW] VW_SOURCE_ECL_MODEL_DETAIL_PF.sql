
DROP VIEW IF EXISTS VW_SOURCE_ECL_MODEL_DETAIL_PF;

CREATE VIEW VW_SOURCE_ECL_MODEL_DETAIL_PF
AS
 SELECT PKID,
    ECL_MODEL_ID,
    SEGMENTATION_ID,
    LT_RULE_ID,
    SICR_RULE_ID,
    UPSIDE_VALUE,
    BASE_VALUE,
    DOWNSIDE_VALUE,
    UPSIDE_PROB_OUTCOME,
    BASE_PROB_OUTCOME,
    DOWNSIDE_PROB_OUTCOME,
    OVERLAY_AMOUNT,
    IS_DELETE,
    CREATEDBY,
    CREATEDDATE,
    CREATEDHOST,
    UPDATEDBY,
    UPDATEDDATE,
    UPDATEDHOST,
    BUCKET_GROUP,
    DEFAULT_RULE_ID
   FROM ( SELECT PKID,
            ECL_MODEL_ID,
            SEGMENTATION_ID,
            LT_RULE_ID::DOUBLE PRECISION,
            SICR_RULE_ID::DOUBLE PRECISION,
            UPSIDE_VALUE::DOUBLE PRECISION,
            BASE_VALUE::DOUBLE PRECISION,
            DOWNSIDE_VALUE::DOUBLE PRECISION,
            UPSIDE_PROB_OUTCOME::DOUBLE PRECISION,
            BASE_PROB_OUTCOME::DOUBLE PRECISION,
            DOWNSIDE_PROB_OUTCOME::DOUBLE PRECISION,
            OVERLAY_AMOUNT::DOUBLE PRECISION,
            IS_DELETE,
            CREATEDBY,
            CREATEDDATE,
            CREATEDHOST,
            UPDATEDBY,
            UPDATEDDATE,
            UPDATEDHOST,
            BUCKET_GROUP::VARCHAR,
            DEFAULT_RULE_ID
           FROM VW_IFRS_ECL_MODEL_DETAIL_PF
        EXCEPT
         SELECT PKID,
            ECL_MODEL_ID,
            SEGMENTATION_ID,
            LT_RULE_ID,
            SICR_RULE_ID,
            UPSIDE_VALUE,
            BASE_VALUE,
            DOWNSIDE_VALUE,
            UPSIDE_PROB_OUTCOME,
            BASE_PROB_OUTCOME,
            DOWNSIDE_PROB_OUTCOME,
            OVERLAY_AMOUNT,
            IS_DELETE,
            CREATEDBY,
            CREATEDDATE,
            CREATEDHOST,
            UPDATEDBY,
            UPDATEDDATE,
            UPDATEDHOST,
            BUCKET_GROUP,
            DEFAULT_RULE_ID
           FROM IFRS_ECL_MODEL_DETAIL_PF) CHECK_IFRS_ECL_MODEL_DETAIL_PF;