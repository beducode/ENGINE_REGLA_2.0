DROP VIEW IF EXISTS VW_MASTER_PRODUCT_PARAM;

CREATE VIEW VW_MASTER_PRODUCT_PARAM AS
SELECT * FROM dblink('workflow_ntt_parameter','SELECT PKID
,DATA_SOURCE
,PRD_TYPE
,PRD_CODE
,PRD_GROUP
,PRD_DESC
,INST_CLS_VALUE
,IS_DELETE
,CREATEDBY
,CREATEDDATE
,CREATEDHOST
FROM (
SELECT A.SYSCODE_PRODUCT,
A.PKID, 
A.DATA_SOURCE, 
A.PRODUCT_TYPE AS PRD_TYPE,
A.PRODUCT_CODE AS PRD_CODE,
A.PRODUCT_GROUP AS PRD_GROUP,
A.DESCRIPTION AS PRD_DESC,
''A'' AS INST_CLS_VALUE,
CASE WHEN A.IS_ACTIVE = TRUE THEN 0 ELSE 1 END IS_DELETE,
''SYSTEM'' AS CREATEDBY,
CURRENT_DATE AS CREATEDDATE,
''LOCALHOST'' AS CREATEDHOST
FROM "MstProduct" A
WHERE A.CODE_APP = ''IFRS_9'' AND A.IS_ACTIVE = TRUE
ORDER BY A.SYSCODE_PRODUCT
) IFRS_MASTER_PRODUCT_PARAM') AS MASTER_PRODUCT_PARAM(PKID BIGINT
,DATA_SOURCE CHARACTER VARYING(20)
,PRD_TYPE CHARACTER VARYING(50)
,PRD_CODE CHARACTER VARYING(20)
,PRD_GROUP CHARACTER VARYING(20)
,PRD_DESC CHARACTER VARYING(100)
,INST_CLS_VALUE CHARACTER(1)
,IS_DELETE INTEGER
,CREATEDBY CHARACTER VARYING(36)
,CREATEDDATE TIMESTAMP WITHOUT TIME ZONE
,CREATEDHOST CHARACTER VARYING(30));