DROP VIEW IF EXISTS VW_LGD_FL_OVERRIDE;
CREATE VIEW VW_LGD_FL_OVERRIDE
AS
SELECT A.DOWNLOAD_DATE AS "Effective Date"
,CURRENT_DATE AS "FL_Date"
,B.LGD_RULE_NAME AS "LGD Rule Name"
,A.LGD_RULE_ID AS "LGD Rule ID"
,COALESCE(A.FL_SEQ,0) AS "FL Sequence"
,COALESCE(A.FL_YEAR,0) AS "FL Year"
,COALESCE(A.FL_MONTH,0) AS "FL Month"
,COALESCE(A.LGD,0) AS "LGD Rate System"
,COALESCE(C.LGD_OVERRIDE,0) AS "LGD Rate Override"
FROM IFRS_LGD_TERM_STRUCTURE A
INNER JOIN IFRS_LGD_RULES_CONFIG B ON A.LGD_RULE_ID = B.PKID
LEFT JOIN IFRS_LGD_FL_OVERRIDE C ON A.LGD_RULE_ID = C.LGD_RULE_ID AND A.DOWNLOAD_DATE = C.EFFECTIVE_DATE
WHERE B.ACTIVE_FLAG = 1 AND B.IS_DELETE = 0;
