CREATE OR REPLACE PROCEDURE SP_IFRS_INS_MOVE_MAP_SEG_ASET
(
   v_CURRDATE    DATE
)
AS
BEGIN

INSERT /*+ PARALLEL (AUTO) APPEND NOLOGGING */
INTO IFRS_MOVE_MAP_SEGMENT_ASETUANG
(SUB_SEGMENT , ASET_KEUANGAN,TRA)
SELECT A.SUB_SEGMENT, A.ASET_KEUANGAN, A.TRA
  FROM (SELECT                                           /*+ PARALLEL(auto) */
              DISTINCT SUB_SEGMENT, ASET_KEUANGAN , TRA
          FROM IFRS_REPORT_ECL_MOVE_VALAS_DTL
         WHERE     report_date = v_CURRDATE
         ) A
         WHERE NOT EXISTS (SELECT 1 FROM IFRS_MOVE_MAP_SEGMENT_ASETUANG MAP
         WHERE NVL(A.SUB_SEGMENT,' ') = NVL(MAP.SUB_SEGMENT,' ')
         AND NVL(A.ASET_KEUANGAN,' ') = NVL(MAP.ASET_KEUANGAN,' ')
         AND NVL(A.TRA,' ') = NVL(MAP.TRA,' '));

        COMMIT;

END;