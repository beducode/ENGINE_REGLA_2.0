CREATE OR REPLACE PROCEDURE  USPS_LGD_RECOVERYANALYSIS_D
(
    V_PERIOD DATE DEFAULT '2000-01-01',
    V_ModelId Number DEFAULT 0,
    Cur_out OUT SYS_REFCURSOR
)
AS
BEGIN

    OPEN Cur_out FOR
    Select A.PKID, A.DOWNLOAD_DATE, A.ACCOUNT_NUMBER, A.CUSTOMER_NUMBER, A.CUSTOMER_NAME, A.TOTAL_LOSS_AMT, A.RECOV_AMT_BF_NPV, A.RECOVERY_AMOUNT, A.RECOV_PERCENTAGE
    from ifrs_lgd A
    join ifrs_lgd_rules_config B on (A.SEGMENTATION_ID=B.SEGMENTATION_ID and A.LGD_RULE_ID=B.PKID)
    Where A.DOWNLOAD_DATE=V_PERIOD and A.LGD_RULE_ID=V_ModelId;

END;