CREATE OR REPLACE PROCEDURE SP_IFRS_INSERT_TMP_IMA_GL (
    v_DOWNLOADDATE   DATE DEFAULT NULL)
AS
    V_CURRDATE   DATE;
    V_PREVDATE   DATE;
BEGIN
    EXECUTE IMMEDIATE 'alter
session enable parallel dml';

    SELECT MAX (CURRDATE), LAST_DAY (ADD_MONTHS (MAX (PREVDATE), -1))
      INTO V_CURRDATE, V_PREVDATE
      FROM IFRS_PRC_DATE;

    EXECUTE IMMEDIATE 'TRUNCATE TABLE IFRS_TMP_IMA_GL_BCA';

    INSERT /*+ PARALLEL(8) */
           INTO IFRS_TMP_IMA_GL_BCA
        SELECT /*+ PARALLEL(8) */
               *
          FROM IFRS_MASTER_ACCOUNT
         WHERE DOWNLOAD_DATE IN (V_CURRDATE, V_PREVDATE);

    COMMIT;
END;