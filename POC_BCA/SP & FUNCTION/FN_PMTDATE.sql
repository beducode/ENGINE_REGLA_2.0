CREATE OR REPLACE FUNCTION FN_PMTDATE(V_PMTDATE IN DATE,V_INT IN NUMBER)
RETURN DATE
AS
V_DATE DATE;
BEGIN
  IF EXTRACT(DAY FROM V_PMTDATE) <= 28 THEN
    V_DATE:= ADD_MONTHS(V_PMTDATE, V_INT);
  ELSE
    V_DATE:= LEAST(ADD_MONTHS(V_PMTDATE, V_INT),ADD_MONTHS(TRUNC(V_PMTDATE, 'MONTH'), V_INT)+ (V_PMTDATE - TRUNC(V_PMTDATE, 'MONTH')));
  END IF;

  RETURN V_DATE;
END;