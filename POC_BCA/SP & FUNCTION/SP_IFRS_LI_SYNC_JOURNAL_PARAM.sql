CREATE OR REPLACE PROCEDURE SP_IFRS_LI_SYNC_JOURNAL_PARAM
AS
    V_CURRDATE DATE;
    V_PREVDATE DATE;

BEGIN
    SELECT MAX(CURRDATE),	MAX(PREVDATE)
    INTO V_CURRDATE,V_PREVDATE
    FROM IFRS_LI_PRC_DATE_AMORT;

    INSERT INTO IFRS_LI_AMORT_LOG (DOWNLOAD_DATE,DTM,OPS,PROCNAME,REMARK)
    VALUES (V_CURRDATE,SYSTIMESTAMP,'START','SP_IFRS_LI_SYNC_JOURNAL_PARAM','');

    -- UPDATE FOR TRX_TYPE DEBET CHANGE TO DB
    UPDATE IFRS_MASTER_JOURNAL_PARAM
    SET TRX_CODE = 'DB'
    WHERE SUBSTR(TXN_TYPE, 1, 1) = 'D';

    EXECUTE IMMEDIATE 'TRUNCATE TABLE IFRS_LI_JOURNAL_PARAM';

    COMMIT;

    INSERT INTO IFRS_LI_JOURNAL_PARAM (
      JOURNALCODE
      ,GL_CONSTNAME
      ,TRX_CODE
      ,COSTCENTER
      ,CCY
      ,FLAG_CF
      ,DRCR
      ,GLNO
      ,SEQ
      ,JOURNAL_DESC
      ,GL_INTERNAL_CODE
      ,PORTION
      )
    SELECT IFRS_ACCT_TYPE
		,GL_CONSTNAME
		,TRX_CODE
		,'000' AS COST_CENTER
		,CCY
		,IFRS_COST_VALUE
		,SUBSTR(TXN_TYPE, 1, 1)
		,GL_CODE
		,SEQ
		,REMARKS
		,GL_INTERNAL_CODE
		,NVL(PORTION, 100)
	FROM IFRS_MASTER_JOURNAL_PARAM
        WHERE INST_CLS_VALUE = 'L';

    INSERT INTO IFRS_LI_AMORT_LOG (DOWNLOAD_DATE,DTM,OPS,PROCNAME,REMARK)
    VALUES (V_CURRDATE,SYSTIMESTAMP,'END','SP_IFRS_LI_SYNC_JOURNAL_PARAM','');

    COMMIT;
END;